import{j as n,a as e,F as K}from"./index-CTQUlAj9.js";import{r as o}from"./vendor-react-cvpQPKbX.js";import{u as Q}from"./useThemeStyles-CBsmOhDc.js";import{P as _,E as l,h as r,R as w,D as q,u as m,j as z,a9 as T,a0 as J,L as Z,V as b,p as x,an as X,ah as Y,k as A,ao as ee,Z as te,x as $,v as B}from"./vendor-eui-B-2A2V66.js";import"./vendor-emotion-D5W-U9Ga.js";const re=p=>{const C=["TCP","UDP","HTTP","HTTPS","SSH","FTP"],c=["success","warning","danger"],s=["allow","block","monitor"],a=["US","DE","JP","BR","AU","GB","FR","CN","IN","CA"];return Array.from({length:p},(P,d)=>({id:`evt-${1e3+d}`,timestamp:new Date(Date.now()-Math.random()*864e5).toISOString(),source:`192.168.${Math.floor(Math.random()*255)}.${Math.floor(Math.random()*255)}`,destination:`10.0.${Math.floor(Math.random()*255)}.${Math.floor(Math.random()*255)}`,protocol:C[Math.floor(Math.random()*C.length)],port:[22,80,443,3306,5432,8080][Math.floor(Math.random()*6)],bytes:Math.floor(Math.random()*1e6),status:c[Math.floor(Math.random()*c.length)],action:s[Math.floor(Math.random()*s.length)],country:a[Math.floor(Math.random()*a.length)]}))},f=re(100);function ae(){const{euiTheme:p}=_(),C=Q(p.colors.primary),[c,s]=o.useState(0),[a,P]=o.useState(10),[d,U]=o.useState("timestamp"),[y,V]=o.useState("desc"),[k,v]=o.useState([]),[S,D]=o.useState(""),[E,F]=o.useState("all"),M=o.useMemo(()=>{let t=[...f];if(S){const i=S.toLowerCase();t=t.filter(h=>h.source.includes(i)||h.destination.includes(i)||h.protocol.toLowerCase().includes(i)||h.id.toLowerCase().includes(i))}return E!=="all"&&(t=t.filter(i=>i.status===E)),t.sort((i,h)=>{const u=i[d],g=h[d];return typeof u=="string"&&typeof g=="string"?y==="asc"?u.localeCompare(g):g.localeCompare(u):typeof u=="number"&&typeof g=="number"?y==="asc"?u-g:g-u:0}),t},[S,E,d,y]),L=o.useMemo(()=>{const t=c*a;return M.slice(t,t+a)},[M,c,a]),j=t=>t<1024?`${t} B`:t<1024*1024?`${(t/1024).toFixed(1)} KB`:`${(t/(1024*1024)).toFixed(2)} MB`,O=t=>new Date(t).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit"}),G=[{field:"id",name:"Event ID",sortable:!0,width:"100px",render:t=>e(te,{onClick:()=>{},children:t})},{field:"timestamp",name:"Time",sortable:!0,width:"100px",render:t=>e($,{content:new Date(t).toLocaleString(),children:e("span",{children:O(t)})})},{field:"source",name:"Source IP",sortable:!0,render:t=>e("code",{style:{fontFamily:p.font.familyCode},children:t})},{field:"destination",name:"Destination IP",sortable:!0,render:t=>e("code",{style:{fontFamily:p.font.familyCode},children:t})},{field:"protocol",name:"Protocol",sortable:!0,width:"90px",render:t=>e(B,{color:"hollow",children:t})},{field:"port",name:"Port",sortable:!0,width:"70px",align:"right"},{field:"bytes",name:"Size",sortable:!0,width:"90px",align:"right",render:t=>j(t)},{field:"country",name:"Country",sortable:!0,width:"80px",render:t=>e($,{content:t,children:e(B,{color:"hollow",children:t})})},{field:"status",name:"Status",sortable:!0,width:"100px",render:t=>e(T,{color:t,children:t.charAt(0).toUpperCase()+t.slice(1)})},{field:"action",name:"Action",sortable:!0,width:"90px",render:t=>e(B,{color:{allow:"success",block:"danger",monitor:"warning"}[t],children:t.toUpperCase()})},{name:"Actions",width:"80px",actions:[{name:"View",description:"View event details",icon:"eye",type:"icon",onClick:()=>{}},{name:"Block",description:"Block this IP",icon:"cross",type:"icon",color:"danger",onClick:()=>{}}]}],H={pageIndex:c,pageSize:a,totalItemCount:M.length,pageSizeOptions:[10,25,50,100]},R={sort:{field:d,direction:y}},N={selectable:()=>!0,onSelectionChange:v},W=({page:t,sort:i})=>{t&&(s(t.index),P(t.size)),i&&(U(i.field),V(i.direction))},I=o.useMemo(()=>({total:f.length,success:f.filter(t=>t.status==="success").length,warning:f.filter(t=>t.status==="warning").length,danger:f.filter(t=>t.status==="danger").length}),[]);return n(Z.Section,{children:[n(l,{alignItems:"center",justifyContent:"spaceBetween",children:[n(r,{grow:!1,children:[e(z,{size:"l",children:e("h1",{css:C,children:"Network Events"})}),e(m,{color:"subdued",size:"s",children:e("p",{children:"Monitor and analyze network traffic in real-time"})})]}),e(r,{grow:!1,children:e(b,{fill:!0,iconType:"download",children:"Export CSV"})})]}),e(x,{size:"l"}),n(l,{gutterSize:"m",children:[e(r,{children:e(w,{paddingSize:"m",hasBorder:!0,children:n(l,{alignItems:"center",gutterSize:"s",children:[e(r,{grow:!1,children:e(q,{type:"documents",size:"l"})}),n(r,{children:[e(m,{size:"s",children:e("strong",{children:"Total Events"})}),e(z,{size:"s",children:e("h3",{children:I.total.toLocaleString()})})]})]})})}),e(r,{children:e(w,{paddingSize:"m",hasBorder:!0,children:n(l,{alignItems:"center",gutterSize:"s",children:[e(r,{grow:!1,children:e(T,{color:"success"})}),n(r,{children:[e(m,{size:"s",children:e("strong",{children:"Success"})}),e(z,{size:"s",children:e("h3",{children:I.success.toLocaleString()})})]})]})})}),e(r,{children:e(w,{paddingSize:"m",hasBorder:!0,children:n(l,{alignItems:"center",gutterSize:"s",children:[e(r,{grow:!1,children:e(T,{color:"warning"})}),n(r,{children:[e(m,{size:"s",children:e("strong",{children:"Warning"})}),e(z,{size:"s",children:e("h3",{children:I.warning.toLocaleString()})})]})]})})}),e(r,{children:e(w,{paddingSize:"m",hasBorder:!0,children:n(l,{alignItems:"center",gutterSize:"s",children:[e(r,{grow:!1,children:e(T,{color:"danger"})}),n(r,{children:[e(m,{size:"s",children:e("strong",{children:"Blocked"})}),e(z,{size:"s",children:e("h3",{children:I.danger.toLocaleString()})})]})]})})})]}),e(x,{size:"l"}),e(w,{paddingSize:"m",hasBorder:!0,children:n(l,{alignItems:"center",gutterSize:"m",children:[e(r,{grow:2,children:e(X,{placeholder:"Search by IP, protocol, or event ID...",value:S,onChange:t=>{D(t.target.value),s(0)},isClearable:!0,fullWidth:!0})}),e(r,{grow:!1,children:e(Y,{options:[{value:"all",text:"All Statuses"},{value:"success",text:"Success"},{value:"warning",text:"Warning"},{value:"danger",text:"Danger"}],value:E,onChange:t=>{F(t.target.value),s(0)}})}),e(r,{grow:!1,children:e(A,{iconType:"refresh",onClick:()=>{D(""),F("all"),s(0)},children:"Reset"})})]})}),e(x,{size:"m"}),k.length>0&&n(K,{children:[e(J,{title:`${k.length} events selected`,color:"primary",iconType:"check",size:"s",children:n(l,{gutterSize:"s",children:[e(r,{grow:!1,children:e(b,{size:"s",color:"danger",children:"Block Selected IPs"})}),e(r,{grow:!1,children:e(b,{size:"s",children:"Export Selected"})}),e(r,{grow:!1,children:e(A,{size:"s",onClick:()=>v([]),children:"Clear Selection"})})]})}),e(x,{size:"m"})]}),e(ee,{items:L,columns:G,pagination:H,sorting:R,selection:N,onChange:W,itemId:"id"}),e(x,{size:"m"}),e(m,{size:"xs",color:"subdued",textAlign:"center",children:n("p",{children:["Showing ",L.length," of ",M.length," events",S&&` (filtered from ${f.length} total)`]})})]})}export{ae as default};
